<!DOCTYPE html>
<html>
    <head>
        <title>AuthCode Flow + PKCE using OIDC-Client Test</title>
        <link rel='stylesheet' href='styles.css'>
    </head>
    <body>
        <section id="auth-section">
            <h2>Step 1</h2>
            <h3>Authorization</h3>
            <div class="text-block">
                First of all, we need to get an access token using authorization:
            </div>
            <div class="input-field">
                <label>client_id: </label><input type="text" id="client-id" value=""/>
            </div>
            <div class="input-field">
                <label>client_secret: </label><input type="text" id="client-secret" value="" /> 
            </div>
            <button id="authorization"> Authorization </button>
            <a class="link-to-guide" 
                href="https://developer.intermedia.com/api/spec/calling/index.html#dev-guide-auth-guide" 
                target="_blank">Authorization guide</a>

            <pre id='access-token-out'></pre>
        </section>

        <section id="call-recs-section">
            <h2>Step 2</h2>
            <h3>Get call recordings information</h3>
            <div class="text-block">
                Then, we can get detailed information about the user's call recordings.
            </div>
            <div id="get-call-recs-block" class="call-recs-block">
                <div id="get-call-recs-form">
                    <div class="input-field">
                        <label>organizationId: </label><input type="text" id="organization-id" value=""/>
                    </div>
                    <div class="input-field">
                        <label>unifiedUserId: </label><input type="text" id="unified-user-id" value="" />  
                    </div>
                    <button id="get-call-recs"> Get call recordings </button>
                    <a class="link-to-guide" 
                        href="https://developer.intermedia.com/api/spec/calling/index.html#get-/voice/v2/organizations/{organizationId}/users/{unifiedUserId}/call-recordings" 
                        target="_blank">Get call recordings guide</a>
                </div>
                <table id="recs-table" class="recs-table">
                    <tr class="recs-table-header">
                        <th>ID</th>
                        <th>Caller number</th>
                        <th>Duration</th>
                        <th>When created</th>
                    </tr>
                </table>
                <div id="call-recs-navbar">
                    <button id="prev-page-button"></button>
                    <span id="current-page">1</span>
                    <button id="next-page-button"></button>
                </div>

            </div>
            <h2>Step 3</h2>
            <h3>Get call recordings content</h3>
            <div class="text-block">
                There are two ways to get call recordings:<br>
                1. Get call recordings (archive)<br>
                2. Get call recordings (content)<br>
            </div>
            <div id="get-call-recs-archive-block" class="call-recs-block">
                <h4>Get call recordings (archive)</h4>
                <div class="text-block">
                    To get several call recordings in the archive, copy the IDs of the required records from step 2 into the field below (for example [435, 233, 1586]). <br> 
                    Then wait for the download link to appear.
                </div>
                <input type="text" id="call-rec-id-array" value="[]" placeholder="[0, 53, 13]"/>
                <button id="get-call-recs-archive"> Get call recordings (archive) </button>
                <a class="link-to-guide" 
                    href="https://developer.intermedia.com/api/spec/calling/index.html#post-/voice/v2/organizations/{organizationId}/users/{unifiedUserId}/call-recordings/_selected/_content" 
                    target="_blank">Get call recordings (archive) guide</a>
            </div>

            <div id="get-call-recs-content-block" class="call-recs-block">
                <h4>Get call recordings (content)</h4>
                <div class="text-block">
                    To get one call recording, copy its ID from step 2 into the field below.<br>
                    Then wait for the download link to appear.
                </div>
                <input type="text" id="call-rec-id" value="" />
                <button id="get-call-recs-content"> Get call recordings (content) </button>
                <a class="link-to-guide" 
                    href="https://developer.intermedia.com/api/spec/calling/index.html#get-/voice/v2/organizations/{organizationId}/users/{unifiedUserId}/call-recordings/{id}/_content" 
                    target="_blank">Get call recordings (content) guide</a>

            </div>
        </section>
    </body>
    <script src='jwt-decode.js'></script>
    <script src='s2s.js'></script>
</html>
